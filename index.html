<!DOCTYPE html>
<html>

<head>
  <title>KSFA Timer</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Winky+Rough:ital,wght@0,300..900;1,300..900&display=swap"
    rel="stylesheet">
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: sans-serif;
      background-color: black;
      color: white;
      overflow: hidden;
    }

    #credits-button,
    #submit-button,
    #music-toggle-button {
      position: absolute;
      top: 20px;
      background-color: rgba(255, 255, 255, 0.2);
      border: none;
      padding: 10px 15px;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px;
    }

    #credits-button {
      left: 20px;
    }

    #submit-button {
      left: 50%;
      transform: translateX(-50%);
    }

    #music-toggle-button {
      right: 20px;
    }

    #credits-box {
      position: fixed;
      bottom: -100%;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 10px;
      transition: bottom 0.5s ease-in-out;
      text-align: center;
      max-width: 80%;
      box-sizing: border-box;
    }

    #credits-box.show {
      bottom: 50%;
      transform: translate(-50%, 50%);
    }

    #timer {
      font-size: 100px;
      text-align: center;
      font-family: 'Winky Rough', sans-serif;
      font-weight: bold;
      letter-spacing: 0.2em;
      white-space: nowrap;
      overflow: hidden;
      max-width: 100%;
    }

    #timer-labels {
      font-size: 20px;
      text-align: center;
      font-family: sans-serif;
      margin-top: 5px;
      letter-spacing: 0.2em;
      white-space: nowrap;
      overflow: hidden;
      max-width: 100%;
      cursor: pointer;
      user-select: none;
    }

    #message {
      font-size: 80px;
      text-align: center;
      opacity: 0;
      transition: opacity 1s ease-in-out,
      color 0.5s linear;
      font-family: 'Pacifico',
      cursive;
      position: relative;
    }

    .confetti {
      position: absolute;
      width: 15px;
      height: 8px;
      pointer-events: none;
      transform-origin: center;
    }

    @media (max-width: 600px) {
      #timer {
        font-size: 60px;
        letter-spacing: 0.1em;
      }

      #timer-labels {
        font-size: 15px;
        letter-spacing: 0.1em;
      }
    }

    .green-text {
      color: green;
    }

    .orange-text {
      color: orange;
    }

    .red-text {
      color: red;
    }

    .hot-pink-text {
      color: hotpink;
    }

    #music-controls {
      position: absolute;
      top: 60px;
      right: -200px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      transition: right 0.5s ease-in-out;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px;
      border-radius: 10px;
    }

    #music-controls.show {
      right: 20px;
    }

    #music-controls button,
    #music-controls input {
      margin-top: 5px;
      background-color: rgba(255, 255, 255, 0.2);
      border: none;
      padding: 8px 12px;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      width: 150px;
      text-align: left;
    }

    #music-controls input[type="range"] {
      width: 140px;
    }

    #play-pause-button {
      font-size: 1.2em;
      padding: 8px 15px;
    }

    #current-song {
      font-size: 16px;
      margin-bottom: 5px;
    }

    #music-slider {
      width: 150px;
      margin-top: 5px;
    }

    #music-time {
      font-size: 12px;
      margin-bottom: 2px;
    }

    #volume-label {
      font-size: 12px;
      margin-bottom: 2px;
    }

    .bubble {
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background-color: rgba(173, 216, 230, 0.7);
      /* Light blue with some transparency */
      pointer-events: auto;
      /* Make bubbles clickable */
      cursor: pointer;
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }
  </style>
</head>

<body>
  <button id="credits-button">Credits</button>
  <button id="submit-button">Submit</button>
  <button id="music-toggle-button">‚ô´</button>
  <div id="credits-box">
    <p>Created by Samad Slaten</p>
    <p>Picture Senders: <span class="orange-text">Aden Smith</span>, Eryn Alfred, <span class="green-text">Erin Grogan</span>,
      Abram Dolby, <span class="hot-pink-text">Suset Solano</span></p>
    <p>People Who Also Helped: <span class="red-text">Roberto Ochoa</span>, <span class="green-text">Kortni Smith</span>,
      Anthony Royal</p>
  </div>
  <div id="music-controls">
    <div id="current-song"></div>
    <button id="play-pause-button">‚ùö‚ùö</button>
    <button id="loop-button">Loop</button>
    <div id="volume-label">Volume</div>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
    <button id="mute-button">Mute</button>
    <button id="prev-button">Previous</button>
    <button id="next-button">Next</button>
    <button id="bubble-button">ü´ß</button>
    <div id="music-time">00:00 / 00:00</div>
    <input type="range" id="music-slider" min="0" max="100" value="0">
  </div>
  <div id="timer"></div>
  <div id="timer-labels">Days Hours Minutes Seconds</div>
  <div id="message">Good Luck Kippsters!</div>

  <script>
    const creditsButton = document.getElementById('credits-button');
    const submitButton = document.getElementById('submit-button');
    const creditsBox = document.getElementById('credits-box');
    const loopButton = document.getElementById('loop-button');
    const volumeSlider = document.getElementById('volume-slider');
    const muteButton = document.getElementById('mute-button');
    const playPauseButton = document.getElementById('play-pause-button');
    const musicToggleButton = document.getElementById('music-toggle-button');
    const musicControls = document.getElementById('music-controls');
    const prevButton = document.getElementById('prev-button');
    const nextButton = document.getElementById('next-button');
    const currentSongDisplay = document.getElementById('current-song');
    const musicSlider = document.getElementById('music-slider');
    const musicTimeDisplay = document.getElementById('music-time');
    const timerLabelsDisplay = document.getElementById('timer-labels');
    const bubbleButton = document.getElementById('bubble-button');

    let musicControlsVisible = false;

    creditsButton.addEventListener('click', () => {
      creditsBox.classList.toggle('show');
    });

    submitButton.addEventListener('click', () => {
      window.location.href = 'mailto:junpey9@gmail.com?subject=Picture%20Suggestion';
    });

    document.addEventListener('click', (event) => {
      if (creditsBox.classList.contains('show') && !creditsBox.contains(event.target) && event.target !== creditsButton) {
        creditsBox.classList.remove('show');
      }
      if (musicControls.classList.contains('show') && !musicControls.contains(event.target) && event.target !== musicToggleButton) {
        musicControls.classList.remove('show');
      }
    });

    musicToggleButton.addEventListener('click', () => {
      musicControls.classList.toggle('show');
      musicControlsVisible = !musicControlsVisible;
    });

    const targetDate = new Date('April 21, 2025 08:30:00 EST');
    const timerDisplay = document.getElementById('timer');
    const messageDisplay = document.getElementById('message');

    const musicFiles = [{
        url: 'https://file.garden/aABDpAgY3QmuIiLd/yume%202kki%20-%20lotus%20waters%20nightcore_sped%20up_%20techno%20condominium%20flying%20event.mp3',
        name: 'Lotus Waters'
      },
      {
        url: 'https://file.garden/aABDpAgY3QmuIiLd/1-13%20LEASE.mp3',
        name: 'LEASE'
      },
      {
        url: 'https://file.garden/aABDpAgY3QmuIiLd/1-16%20KYO.mp3',
        name: 'KYO'
      },
      {
        url: 'https://file.garden/aABDpAgY3QmuIiLd/1-21%20Yuu.mp3',
        name: 'Yuu'
      },
      {
        url: 'https://file.garden/aABDpAgY3QmuIiLd/DEATHCAMP.mp3',
        name: 'DEATHCAMP'
      },
      {
        url: '',
        name: 'Silence'
      }
    ];
    let currentTrack = 0;
    let audio = new Audio(musicFiles[currentTrack].url);
    let isLooping = false;
    let isMuted = false;
    let isPlaying = true;

    audio.loop = false;
    currentSongDisplay.textContent = musicFiles[currentTrack].name;

    loopButton.addEventListener('click', () => {
      isLooping = !isLooping;
      audio.loop = isLooping;
      loopButton.textContent = isLooping ? 'Loop On' : 'Loop Off';
    });

    volumeSlider.addEventListener('input', () => {
      audio.volume = volumeSlider.value;
    });

    muteButton.addEventListener('click', () => {
      isMuted = !isMuted;
      audio.muted = isMuted;
      muteButton.textContent = isMuted ? 'Unmute' : 'Mute';
    });

    playPauseButton.addEventListener('click', () => {
      if (isPlaying) {
        audio.pause();
        playPauseButton.textContent = '‚ñ∑';
      } else {
        audio.play();
        playPauseButton.textContent = '‚ùö‚ùö';
      }
      isPlaying = !isPlaying;
    });

    audio.addEventListener('ended', () => {
      if (!isLooping) {
        nextSong();
      }
    });

    prevButton.addEventListener('click', () => {
      currentTrack = (currentTrack - 1 + musicFiles.length) % musicFiles.length;
      updateSong();
    });

    nextButton.addEventListener('click', () => {
      nextSong();
    });

    function nextSong() {
      currentTrack = (currentTrack + 1) % musicFiles.length;
      updateSong();
    }

    function updateSong() {
      audio.src = musicFiles[currentTrack].url;
      currentSongDisplay.textContent = musicFiles[currentTrack].name;
      audio.play();
      if (musicFiles[currentTrack].url === '') {
        playPauseButton.textContent = '‚ñ∑';
        isPlaying = false;
      } else {
        playPauseButton.textContent = '‚ùö‚ùö';
        isPlaying = true;
      }
    }

    audio.play();
    playPauseButton.textContent = '‚ùö‚ùö';

    musicSlider.addEventListener('input', () => {
      if (audio.duration) {
        audio.currentTime = (audio.duration * musicSlider.value) / 100;
      }
    });

    audio.addEventListener('timeupdate', () => {
      if (audio.duration) {
        musicSlider.value = (audio.currentTime * 100) / audio.duration;
        musicTimeDisplay.textContent = formatTime(audio.currentTime) + ' / ' + formatTime(audio.duration);
      }
    });

    function formatTime(time) {
      const minutes = Math.floor(time / 60);
      const seconds = Math.floor(time % 60);
      return (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
    }

    function updateTimer() {
      const now = new Date();
      const difference = targetDate - now;

      if (difference <= 0) {
        clearInterval(timerInterval);
        timerDisplay.textContent = '00:00:00:00';
        messageDisplay.style.opacity = 1;
        createConfetti();
        setInterval(changeMessageColor, 500);
        return;
      }

      const days = Math.floor(difference / (1000 * 60 * 60 * 24));
      const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((difference % (1000 * 60)) / 1000);

      let formattedTime = '';

      if (days > 0) {
        formattedTime += days + ':';
        formattedTime += String(hours).padStart(2, '0') + ':';
        formattedTime += String(minutes).padStart(2, '0') + ':';
        formattedTime += String(seconds).padStart(2, '0');
      } else if (hours > 0) {
        formattedTime += hours + ':';
        formattedTime += String(minutes).padStart(2, '0') + ':';
        formattedTime += String(seconds).padStart(2, '0');
      } else {
        formattedTime += String(minutes).padStart(2, '0') + ':';
        formattedTime += String(seconds).padStart(2, '0');
      }

      timerDisplay.textContent = formattedTime;
    }

    function getRandomColor() {
      const letters = '0123456789ABCDEF';
      let color = '#';
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    function changeMessageColor() {
      messageDisplay.style.color = getRandomColor();
    }

    function createConfetti() {
      const messageRect = messageDisplay.getBoundingClientRect();
      const messageLeft = messageRect.left;
      const messageRight = messageRect.right;
      const messageCenterY = messageRect.top + messageRect.height / 2;

      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.backgroundColor = getRandomColor();

        let side = messageLeft;
        let xDirection = 1;

        if (i % 2 === 0) {
          side = messageRight;
          xDirection = -1;
        }

        confetti.style.left = side + 'px';
        confetti.style.top = messageCenterY + 'px';

        const angle = (Math.random() - 0.5) * Math.PI / 2;
        const speed = Math.random() * 5 + 3;
        const xSpeed = Math.cos(angle) * speed * xDirection;
        const ySpeed = Math.sin(angle) * speed;

        document.body.appendChild(confetti);

        const lifetime = Math.random() * 2000 + 1000;

        setTimeout(() => {
          confetti.style.transition = `transform ${lifetime / 1000}s linear, opacity ${lifetime / 1000}s linear`;
          confetti.style.transform = `translate(${xSpeed * 200}px, ${ySpeed * 200}px) rotate(${Math.random() * 360}deg)`;
          confetti.style.opacity = 0;

          setTimeout(() => {
            confetti.remove();
          }, lifetime);
        }, 10);
      }
    }

    bubbleButton.addEventListener('click', () => {
      createBubbles();
    });

    function createBubbles() {
      const numBubbles = 10;
      for (let i = 0; i < numBubbles; i++) {
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        const startX = Math.random() * window.innerWidth;
        const startY = window.innerHeight;
        bubble.style.left = startX + 'px';
        bubble.style.top = startY + 'px';

        const endY = Math.random() * -window.innerHeight;
        const endX = Math.random() * window.innerWidth;

        const duration = Math.random() * 3000 + 2000;

        document.body.appendChild(bubble);

        setTimeout(() => {
          bubble.style.transition = `transform ${duration / 1000}s linear, opacity ${duration / 1000}s linear`;
          bubble.style.transform = `translate(${endX - startX}px, ${endY - startY}px)`;
          bubble.style.opacity = 0;
          setTimeout(() => {
            bubble.remove();
          }, duration);
        }, 10);

        bubble.addEventListener('click', () => {
          bubble.remove();
        });
      }
    }

    updateTimer();
    const timerInterval = setInterval(updateTimer, 1000);

    window.addEventListener('load', () => {
      audio.play().catch(error => {
        console.error('Autoplay prevented:', error);
      });
    });
  </script>
</body>

</html>
